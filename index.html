<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ¬ M3U8 è§†é¢‘æ’­æ”¾é¡µ</title>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<style>
Â  * { box-sizing: border-box; margin: 0; padding: 0; }
Â  body {
Â  Â  background: #000;
Â  Â  color: #fff;
Â  Â  font-family: Arial, sans-serif;
Â  Â  overflow: hidden;
Â  }
Â  #videoContainer {
Â  Â  position: relative;
Â  Â  width: 100%;
Â  Â  height: 100vh;
Â  }
Â  video {
Â  Â  width: 100%;
Â  Â  height: 100%;
Â  Â  object-fit: cover;
Â  Â  background: #000;
Â  }
Â  #loading {
Â  Â  position: absolute;
Â  Â  top: 0; left: 0;
Â  Â  width: 100%; height: 100%;
Â  Â  background: #000;
Â  Â  display: flex;
Â  Â  align-items: center;
Â  Â  justify-content: center;
Â  Â  font-size: 1.2rem;
Â  Â  color: #aaa;
Â  Â  transition: opacity 0.5s;
Â  Â  z-index: 5;
Â  }
Â  #cover {
Â  Â  position: absolute;
Â  Â  top: 0; left: 0;
Â  Â  width: 100%; height: 100%;
Â  Â  object-fit: cover;
Â  Â  z-index: 10;
Â  Â  cursor: pointer;
Â  }
Â  #qrOverlay {
Â  Â  position: absolute;
Â  Â  top: 0; left: 0;
Â  Â  width: 100%; height: 100%;
Â  Â  background: rgba(0,0,0,0.95);
Â  Â  color: #fff;
Â  Â  display: flex; 
Â  Â  flex-direction: column;
Â  Â  justify-content: center;
Â  Â  align-items: center;
Â  Â  z-index: 100; /* æœ€é«˜å±‚çº§ */
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.5s ease-in-out;
Â  }
Â  #qrOverlay img {
Â  Â  width: 220px;
Â  Â  height: 220px;
Â  Â  border-radius: 10px;
Â  Â  margin-bottom: 20px;
Â  }
Â  #qrOverlay button {
Â  Â  background: #00c853;
Â  Â  border: none;
Â  Â  padding: 12px 28px;
Â  Â  border-radius: 8px;
Â  Â  font-size: 16px;
Â  Â  cursor: pointer;
Â  Â  color: #fff;
    transition: background-color 0.3s;
Â  }
  #qrOverlay button:disabled {
    background: #555;
    color: #999;
    cursor: not-allowed;
  }
  
  /* æ–°å¢ï¼šæ’­æ”¾ä¸‹ä¸€é›†æŒ‰é’®æ ·å¼ */
  #nextBtn {
    position: absolute;
    z-index: 50;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    padding: 15px 30px;
    font-size: 1.2rem;
    background: #00c853;
    color: white;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    display: none; /* é»˜è®¤éšè— */
  }
</style>
</head>
<body>
<div id="videoContainer">
Â  <div id="loading">æ­£åœ¨åŠ è½½è§†é¢‘...</div>
Â  <video id="video" playsinline webkit-playsinline></video>
Â  <img id="cover" />
  <button id="nextBtn">æ’­æ”¾ä¸‹ä¸€é›†</button>
  
Â  <div id="qrOverlay">
Â  Â  <img src="qr.jpg" alt="åˆ†äº«äºŒç»´ç ">
Â  Â  <p>è¯·å°†æ­¤äºŒç»´ç åˆ†äº«åˆ°å¾®ä¿¡ç¾¤æˆ–å¥½å‹ï¼Œè§£é”åç»­è§†é¢‘</p>
Â  Â  <button id="sharedBtn" disabled>æˆ‘å·²åˆ†äº«</button>
Â  </div>
</div>

<script>
(function() {
Â  const video = document.getElementById('video');
Â  const loading = document.getElementById('loading');
Â  const cover = document.getElementById('cover');
Â  const qrOverlay = document.getElementById('qrOverlay');
Â  const sharedBtn = document.getElementById('sharedBtn');
  const nextBtn = document.getElementById('nextBtn'); // è·å–æ–°æŒ‰é’®

  let hls; // HLS æ’­æ”¾å™¨å®ä¾‹

Â  // --- è§†é¢‘åˆ—è¡¨å’Œå°é¢å›¾ç‰‡ç¡¬ç¼–ç  (å…³é”®ä¿®æ”¹) ---
Â  const data = {
    // è¯·ç¡®ä¿ 'cover.jpg' æ–‡ä»¶å­˜åœ¨äºä½ çš„ä»“åº“ä¸­
    cover: 'cover.jpg' 
  };
  const list = [
    "https://v202509.fhbbff.com/20251025/YvivGiif/index.m3u8",
    "https://v202509.fhbbff.com/20251025/KJSSxEk1/index.m3u8",
    "https://v202509.fhbbff.com/20251023/tc19cBGs/index.m3u8",
    "https://v202509.fhbbff.com/20251026/PbfagE2m/index.m3u8",
    "https://v202509.fhbbff.com/20251026/C3JARqNJ/index.m3u8"
  ];
Â  let current = parseInt(localStorage.getItem('videoIndex') || 0);
Â  let shared = localStorage.getItem('sharedDone') === 'true';
  let hasIncremented = false; 
  let timerInterval = null; 

Â  // è®¾ç½®å°é¢
Â  cover.src = data.cover;
Â  cover.onclick = () => {
Â  Â  cover.style.display = 'none';
Â  Â  startPlay();
Â  };

  function showQrWithDelay() {
    // éšè—ä¸‹ä¸€é›†æŒ‰é’®
    nextBtn.style.display = 'none';
    
    // 1. æ˜¾ç¤ºé®ç½©å±‚ï¼ˆå¸¦åŠ¨ç”»ï¼‰
    qrOverlay.style.display = 'flex';
    setTimeout(() => { 
      qrOverlay.style.opacity = 1; 
      qrOverlay.style.visibility = 'visible'; 
    }, 10);

    // 2. ç¦ç”¨æŒ‰é’®å¹¶å¼€å§‹å€’è®¡æ—¶
    sharedBtn.disabled = true;
    let countdown = 10;
    sharedBtn.textContent = `è¯·ç­‰å¾… ${countdown} ç§’...`;

    if (timerInterval) clearInterval(timerInterval); 

    timerInterval = setInterval(() => {
        countdown--;
        if (countdown > 0) {
            sharedBtn.textContent = `è¯·ç­‰å¾… ${countdown} ç§’...`;
        } else {
            // å€’è®¡æ—¶ç»“æŸ
            clearInterval(timerInterval);
            timerInterval = null;
            sharedBtn.disabled = false;
            sharedBtn.textContent = 'æˆ‘å·²åˆ†äº«';
        }
    }, 1000);
  }

Â  // è‡ªåŠ¨åŠ è½½ä¸æ’­æ”¾
Â  function startPlay() {
    // æ’­æ”¾å‰éšè—ä¸‹ä¸€é›†æŒ‰é’®
    nextBtn.style.display = 'none';
    
Â  Â  if (current >= list.length) current = 0;
Â  Â  const videoUrl = list[current];
Â  Â  loading.style.display = 'flex';
    hasIncremented = false; 
    
    // --- M3U8/HLS æ’­æ”¾é€»è¾‘ (å…³é”®ä¿®æ”¹) ---
    if (Hls.isSupported()) {
        if (hls) hls.destroy();
        hls = new Hls();
        hls.loadSource(videoUrl);
        hls.attachMedia(video);

        hls.on(Hls.Events.MANIFEST_PARSED, function(event, data) {
            // M3U8 è§£ææˆåŠŸï¼Œè§†é¢‘å¯ä»¥æ’­æ”¾
            loading.style.display = 'none';
            video.play().catch(()=>{});

            // æ’­æ”¾å³è®¡æ•° (éœ€æ±‚ 2)
            if (!hasIncremented) {
                current++;
                localStorage.setItem('videoIndex', current);
                hasIncremented = true;
            }
        });
        
        hls.on(Hls.Events.ERROR, function(event, data) {
            // é”™è¯¯å¤„ç†ï¼Œé˜²æ­¢å¡æ­»
            if (data.fatal) {
                console.error('HLS Fatal Error:', data);
                loading.style.display = 'none';
                alert('è§†é¢‘æµåŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥è§†é¢‘æºæˆ–ç½‘ç»œã€‚');
            }
        });
    } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
        // iOS/Safari åŸç”Ÿæ”¯æŒ M3U8 
        video.src = videoUrl;
        video.load();
        
        video.oncanplay = () => {
             loading.style.display = 'none
